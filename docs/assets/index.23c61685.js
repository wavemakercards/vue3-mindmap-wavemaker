import{m as e,r as t,p as n,s as a,c as l,l as o,a as i,b as s,z as r,d,i as c,e as h,t as u,h as p,f as g,g as m,o as f,P as v,E as b,j as x,k as y,u as w,n as _,q as k,w as $,v as M,x as B,y as C,F as z,A as L,B as S,C as D,D as E,G as N,H as A,I as V,J as P,K as T,L as j,M as G,N as O}from"./vendor.195fe4a0.js";var K=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get svg(){return ce},get g(){return he},get asstSvg(){return ue},get foreign(){return pe}}),R=[{name:" How to learn D3 "}];var H={collapse:"Collapse this node",expand:"Expand from here",delete:"Delete Node","delete-one":"Delete a single node",add:"Add Child node","add-parent":"Add Parent node","add-sibling":"Add Sibling node","add-sibling-before":"Add Sibling node before",cut:"Cut",copy:"Copy",paste:"Paste",selectall:"Select all",zoomin:"Zoom in",zoomout:"Zoom out",zoomfit:"Zoom fit"};const I=e();var W={container:"Mindmap_container_fgvb6","svg-wrapper":"Mindmap_svg-wrapper_fgvb6","asst-svg":"Mindmap_asst-svg_fgvb6",svg:"Mindmap_svg_fgvb6",trigger:"Mindmap_trigger_fgvb6",dragging:"Mindmap_dragging_fgvb6","add-btn":"Mindmap_add-btn_fgvb6",hidden:"Mindmap_hidden_fgvb6","expand-btn":"Mindmap_expand-btn_fgvb6",text:"Mindmap_text_fgvb6",selected:"Mindmap_selected_fgvb6",content:"Mindmap_content_fgvb6",root:"Mindmap_root_fgvb6",edited:"Mindmap_edited_fgvb6",outline:"Mindmap_outline_fgvb6",collapse:"Mindmap_collapse_fgvb6","button-list":"Mindmap_button-list_fgvb6","right-bottom":"Mindmap_right-bottom_fgvb6","right-top":"Mindmap_right-top_fgvb6",disabled:"Mindmap_disabled_fgvb6",gps:"Mindmap_gps_fgvb6",fit:"Mindmap_fit_fgvb6",download:"Mindmap_download_fgvb6",prev:"Mindmap_prev_fgvb6",next:"Mindmap_next_fgvb6",close:"Mindmap_close_fgvb6"};const Y=t(),U=t(),F=t(),Z=t(),q=t(),J=t();function X(){const e=this.querySelector(`g.${W["add-btn"]}`);e&&(e.style.opacity="1")}function Q(){const e=this.querySelector(`g.${W["add-btn"]}`);e&&(e.style.opacity="0")}const ee=(e,t)=>{e.stopPropagation(),it(t)};function te(e,t){var n,a;const l=null==(n=this.parentNode)?void 0:n.parentNode,{foreign:o}=K;if(je&&o&&J.value){l.classList.add(W.edited),I.emit("edit-flag",!1),o.attr("x",t.x-2-(t.left?t.width:0)).attr("y",t.y-un.data.y-2).attr("data-id",t.id).attr("data-name",t.name).style("display","");const e=J.value;e.textContent=t.name,e.focus(),null==(a=getSelection())||a.selectAllChildren(e);const n=l.querySelector(`:scope > .${W.content}`);n&&ut(n)}}const ne=()=>{var e;if(null==(e=document.getElementsByClassName(W.edited)[0])||e.classList.remove(W.edited,W.selected),q.value&&J.value){q.value.style.display="none";const e=q.value.getAttribute("data-id"),t=q.value.getAttribute("data-name"),n=J.value.textContent;e&&null!==n&&n!==t&&gn(e,n)}},ae=e=>{if(e.preventDefault(),!Y.value)return;const t=ot(Y.value,e);me.value=t;const n=e.composedPath().find((e=>{var t;return null==(t=e.classList)?void 0:t.contains("node")}));if(n){const{classList:e}=n,t=e.contains(W.root),a=e.contains(W.collapse);e.contains(W.selected)||it(n),be.value.disabled=t,ke.value.disabled=t,Be.value.disabled=t,we.value.disabled=t,_e.value.disabled=t,ye.value.disabled=t,ve.value.disabled=!a,fe.value.disabled=a||e.contains("leaf"),ge.value=!1}else ge.value=!0;I.emit("showContextmenu",!0)},le=e=>{var t,n;switch(e){case"zoomfit":ht();break;case"zoomin":case"zoomout":pt(!0);break;case"add":oe(new MouseEvent("click"),st());break;case"delete":bn(st().id);break;case"delete-one":xn(st().id);break;case"collapse":wn(st().id);break;case"expand":yn(st().id);break;case"add-sibling":{const e=st(),t=_n(e.id,"");t&&ie(t)}break;case"add-sibling-before":{const e=st(),t=_n(e.id,"",!0);t&&ie(t)}break;case"add-parent":{const e=st(),t=kn(e.id,"");t&&ie(t)}break;case"cut":{const{id:e}=st(),n=null==(t=un.find(e))?void 0:t.rawData;n&&navigator.clipboard.writeText(JSON.stringify(n)),bn(e)}break;case"copy":{const e=st(),t=null==(n=un.find(e.id))?void 0:n.rawData;t&&navigator.clipboard.writeText(JSON.stringify(t))}break;case"paste":{const e=st();navigator.clipboard.readText().then((t=>{const n=vt(t)||{name:t};vn(e.id,n)}))}}},oe=(e,t)=>{const n=vn(t.id,"");n&&ie(n,e)};function ie(e,t=new MouseEvent("click")){const{g:n}=K;if(!n)return;const a=n.selectAll(`g[data-id='${yt(e)}'] > g.${W.content} > g.${W.text}`).node();a&&(I.emit("edit-flag",!0),te.call(a,t,e))}const se=(e,t)=>{yn(t.id)};const re=e=>{const{svg:t}=K;t&&(e?(Ze(t),t.on("dblclick.zoom",null)):t.on(".zoom",null))},de=e=>{Y.value&&(e?Y.value.addEventListener("contextmenu",ae):Y.value.removeEventListener("contextmenu",ae))};let ce,he,ue,pe;I.on("selection-svg",(e=>ce=e)),I.on("selection-g",(e=>he=e)),I.on("selection-asstSvg",(e=>ue=e)),I.on("selection-foreign",(e=>pe=e));const ge=t(!0),me=t({left:0,top:0}),fe=t({name:"collapse",disabled:!0}),ve=t({name:"expand",disabled:!0}),be=t({name:"delete",disabled:!1}),xe=t({name:"add",disabled:!1}),ye=t({name:"add-parent",disabled:!1}),we=t({name:"add-sibling",disabled:!1}),_e=t({name:"add-sibling-before",disabled:!0}),ke=t({name:"cut",disabled:!1}),$e=t({name:"copy",disabled:!1}),Me=t({name:"paste",disabled:!1}),Be=t({name:"delete-one",disabled:!1}),Ce=l((()=>[[xe.value,ye.value,we.value,_e.value],[ke.value,$e.value,Me.value,be.value,Be.value],[{name:"selectall",disabled:!0}],[fe.value,ve.value]].filter(((e,t)=>0!==t&&1!==t||Qe.value.edit)))),ze=l((()=>[[{name:"zoomin",disabled:Fe.value.k>=Te[1]},{name:"zoomout",disabled:Fe.value.k<=Te[0]},{name:"zoomfit",disabled:!1}],[{name:"selectall",disabled:!0}]])),Le=l((()=>ge.value?ze.value:Ce.value)),Se=o().source((e=>e.source)).target((e=>e.target)),De=i().curve(s),Ee=({source:e,target:t})=>De([e,t]);let Ne=!1,Ae=Se;const Ve=t(!1);I.on("sharp-corner",(e=>{Ne!==e&&(Ve.value=!0),Ne=!!e,Ae=e?Ee:Se}));let Pe=4;I.on("branch",(e=>Pe=e||Pe));let Te=[.1,8];I.on("scale-extent",(e=>Te=e||Te));let je=!1;I.on("edit-flag",(e=>je=!!e));let Ge=18,Oe=84,Ke=Math.min(Ge/2-1,10);I.on("gap",(e=>{e&&(Oe=e.xGap,Ge=e.yGap,Ke=Math.min(Ge/2-1,10),Ke=Math.min(Oe/2-1,Ke))}));const Re=new ResizeObserver((e=>{const{foreign:t}=K;if(!t)return;const n=e[0],a=n.target,{width:l,height:o}=n.contentRect,i=2*(parseInt(getComputedStyle(a).paddingLeft||"0",10)+parseInt(getComputedStyle(a.parentNode).borderTopWidth||"0",10));t.attr("width",l+i).attr("height",o+i),"none"!==t.style("display")&&ut(a)})),He={side:12,padding:2,margin:8},Ie=He.side+2*He.padding,We=16,Ye=4,Ue=2,Fe=t(c),Ze=r().on("zoom",(e=>{const{g:t}=K;t&&(Fe.value=e.transform,t.attr("transform",e.transform.toString()))})).scaleExtent(Te),qe=d().container((function(){var e,t;return null==(t=null==(e=this.parentNode)?void 0:e.parentNode)?void 0:t.parentNode})).on("drag",(function(e,t){var a;const l=null==(a=this.parentNode)?void 0:a.parentNode;U.value&&U.value.classList.add(W.dragging);const{g:o}=K;if(!o)return;dt(l,t,[e.x-t.x,e.y-t.y]);const i=n(e,F.value);i[1]+=un.data.y;const s=o.selectAll("g.node").filter((e=>{if(e!==t&&e!==t.parent&&!e.id.startsWith(t.id)){let t=Ke,n=e.width+Ke;e.left&&0!==e.depth&&([t,n]=[n,t]);const a={x0:e.x-t,x1:e.x+n,y0:e.y-Ke,y1:e.y+e.height+Ke};return i[0]>a.x0&&i[1]>a.y0&&i[0]<a.x1&&i[1]<a.y1}return!1})),r=Array.from(document.getElementsByClassName(W.outline)),d=s.node();r.forEach((e=>{e!==d&&e.classList.remove(W.outline)})),null==d||d.classList.add(W.outline)})).on("end",(function(e,t){var n;const l=null==(n=this.parentNode)?void 0:n.parentNode;U.value&&U.value.classList.remove(W.dragging);const o=document.getElementsByClassName(W.outline)[0];if(o){o.classList.remove(W.outline);const e=o.getAttribute("data-id");if(!e)throw new Error("outline data-id null");return t.px=0,t.py=0,void mn(e,t.id)}const i=t.x-un.getRootWidth()/2,s=1===t.depth&&i*(i+t.px)<0,r=s?e=>e.left!==t.left:e=>e.left===t.left,d=l.parentNode;let c=s?{y:1/0,id:t.id}:t,h=s?{y:-1/0,id:t.id}:t;const u=a(d).selectAll(`g.${bt(t).join(".")}`).filter((e=>e!==t&&r(e))),p=t.y+t.py;u.each((e=>{(s||e.y>t.y)&&e.y<p&&e.y>h.y&&(h=e),(s||e.y<t.y)&&e.y>p&&e.y<c.y&&(c=e)})),c.id!==t.id?(t.px=0,t.py=0,fn(t.id,c.id)):h.id!==t.id?(t.px=0,t.py=0,fn(t.id,h.id,1)):s?(t.px=0,t.py=0,$n(t.id)):dt(l,t,[0,0],500)})),Je=t(!1);let Xe;I.on("mindmap-context",(e=>e?Xe=e:null));const Qe=t({drag:!1,edit:!1});const et=new class{constructor(e=20){this.length=e,this.snapshots=[],this.cursor=-1}get hasPrev(){return this.cursor>0}get hasNext(){return this.snapshots.length>this.cursor+1}snap(e){const t=h.cloneDeep(e);for(;this.cursor<this.snapshots.length-1;)this.snapshots.pop();this.snapshots.push(t),this.snapshots.length>this.length&&this.snapshots.shift(),this.cursor=this.snapshots.length-1}prev(){return this.hasPrev?(this.cursor-=1,h.cloneDeep(this.snapshots[this.cursor])):null}next(){return this.hasNext?(this.cursor+=1,h.cloneDeep(this.snapshots[this.cursor])):null}},tt=t(!1),nt=t(!1),at=e=>{const t=e.split("\n");return t.length>1&&""===t[t.length-1]&&t.pop(),t},lt=(e,t)=>u().duration(e).ease(t),ot=(e,t)=>{const{pageX:n,pageY:a}=t,l=e.getBoundingClientRect();return{left:n-(l.left+window.pageXOffset),top:a-(l.top+window.pageYOffset)}};function it(e){const t=e instanceof SVGGElement?e:document.querySelector(`g[data-id='${yt(e)}']`),n=document.getElementsByClassName(W.selected)[0];if(!t)throw new Error("selectGNode failed");n?n!==t?(n.classList.remove(W.selected),t.classList.add(W.selected)):I.emit("edit-flag",!0):t.classList.add(W.selected)}function st(){return a(`.${W.selected}`).data()[0]}const rt=e=>{const{asstSvg:t}=K;if(!t)throw new Error("asstSvg undefined");const n=at(e),a=t.append("text");a.selectAll("tspan").data(n).enter().append("tspan").text((e=>e)).attr("x",0);const l=a.node().getBBox();return a.remove(),{width:Math.max(l.width,22),height:Math.max(l.height,22)*n.length}},dt=(e,t,n,l=0)=>{const o=lt(l,g);t.px=n[0],t.py=n[1],a(e).transition(o).attr("transform",xt),a(`g[data-id='${yt(t)}'] > path`).transition(o).attr("d",(e=>_t(e)))},ct=()=>{const{svg:e}=K;if(!e)return;const t=un.data;Ze.translateTo(e,0+t.width/2,0+t.height/2)},ht=()=>{const{svg:e}=K;if(!e||!F.value||!U.value)return;const t=F.value.getBBox(),n=U.value.getBoundingClientRect();let a=Math.min(n.width/t.width,n.height/t.height);a>3&&(a=1);const l=n.width/2,o=n.height/2,i=t.width*a/2,s=t.height*a/2,r=c.translate(-t.x*a+l-i,-t.y*a+o-s).scale(a);Ze.transform(e,r)},ut=e=>{const{svg:t}=K;if(t&&U.value){const{k:n}=Fe.value,a=e.getBoundingClientRect(),{x:l,y:o,width:i,height:s}=U.value.getBoundingClientRect(),r=a.x-l,d=r+a.width,c=a.y-o,h=c+a.height,u=2;let p=0,g=0;r<0&&(p=-r/n+u),(a.width>i||d>i)&&(p=-(d-i)/n-u),c<0&&(g=-c/n+u),(a.height>s||h>s)&&(g=-(h-s)/n-u),Ze.translateBy(t,p,g)}},pt=e=>{const{svg:t}=K;t&&Ze.scaleBy(t,e?1.1:.9)},gt=()=>{var e,t;Y.value&&(e=Y.value,t=un.data.name,p(e).then((e=>{const n=e.toDataURL(),a=open();a&&(a.document.write(`<img src='${n}'>`),a.document.title=t,a.document.close())})))},mt=()=>{const e=et.next();e&&(un.data=e,pn(!1))},ft=()=>{const e=et.prev();e&&(un.data=e,pn(!1))},vt=e=>{let t;try{return t=JSON.parse(e),"name"in t&&t}catch(n){return!1}},bt=e=>{const t=["node"];return e&&t.push(`depth-${e.depth}`),t},xt=e=>`translate(${e.dx+e.px},${e.dy+e.py})`,yt=e=>e.id,wt=e=>{const t=at(e.name),n=e.height/t.length;return t.map((e=>({name:e,height:n})))},_t=e=>{let t=0,n=0;const a=Math.max(Ke-3,0);let l=e.width+a;let o=3;const{parent:i}=e;i&&(t=i.width,n=i.height,0===i.depth&&(Ne||(t/=2),n/=2,o=0)),e.left&&(i&&(0!==i.depth?t=-t:Ne&&(t=0)),l=-l);const s=[-e.dx+t-e.px,-e.dy+n+o-e.py],r=[0,e.height+3];return`${Ae({source:s,target:r})}L${l},${r[1]}`},kt=(e,t,n,a,l)=>{e?(Dt(t,10),zt(n,10,6),Lt(a,10),l&&St(l,10)):(Dt(t,Ke),zt(n,Ke),Lt(a,Ke),l&&St(l,Ke))},$t=(e,t)=>{const n=e.attr("class",(e=>(e=>{const t=bt(e);return e&&(0===e.depth&&t.push(W.root),e.collapse?t.push(W.collapse):e.children&&0!==e.children.length||t.push("leaf")),t})(e).join(" "))).attr("data-id",yt);(t?n.transition(t):n).attr("transform",xt)},Mt=(e,t)=>{(t?e.transition(t):e).attr("transform",(e=>`translate(${e.left?-e.width:0},0)`))},Bt=e=>{e.attr("alignment-baseline","text-before-edge").text((e=>e.name||" ")).attr("x",0).attr("dy",((e,t)=>t?e.height:0))},Ct=(e,t)=>{e.attr("cx",t).attr("cy",0).attr("r",1)},zt=(e,t,n=4)=>{e.attr("x",(e=>-t-(e.left?e.width:0))).attr("y",-t).attr("rx",n).attr("ry",n).attr("width",(e=>e.width+2*t)).attr("height",(e=>e.height+2*t))},Lt=(e,t)=>{e.attr("class",W["expand-btn"]).attr("transform",(e=>((e,t)=>{const n=0===e.depth?e.height/2:e.height+3;let a=e.width+t+We/2+4;return e.left&&(a=-a),`translate(${a},${n})`})(e,t))).style("color",(e=>e.color))},St=(e,t)=>{e.attr("class",(e=>(e=>{const t=[W["add-btn"]];return e.collapse&&t.push(W.hidden),t})(e).join(" "))).attr("transform",(e=>((e,t)=>{const n=0===e.depth?e.height/2:e.height+3;let a=e.width+t+Ie/2+He.margin;return e.left&&(a=-a),`translate(${a},${n})`})(e,t)))},Dt=(e,t)=>{const n=Ie+He.margin,a=2*t;e.attr("class",W.trigger).attr("x",(e=>-t-(e.left?e.width+n:0))).attr("y",-t).attr("width",(e=>e.width+a+n)).attr("height",(e=>e.height+a))},Et=(e,t)=>{const n=e.attr("stroke",(e=>e.color)).attr("stroke-width",Pe);if(t){const e=n.transition(t);Ve.value?e.attrTween("d",Nt):e.attr("d",_t)}else n.attr("d",_t)};function Nt(e,t,n){const a=_t(e),l=n[t],o=l.cloneNode(),i=l.getTotalLength();o.setAttribute("d",a);const s=o.getTotalLength(),r=[0],d=10/Math.max(i,s);let c=0;for(;(c+=d)<1;)r.push(c);r.push(1);const h=r.map((e=>{const t=l.getPointAtLength(e*i),n=o.getPointAtLength(e*s);return m([t.x,t.y],[n.x,n.y])}));return e=>e<1?"M"+h.map((t=>t(e))).join("L"):a}const At=e=>{const t=e.append("tspan");return Bt(t),t},Vt=e=>(Bt(e),e),Pt=e=>{const t=e.append("g");return(e=>{const{side:t,padding:n}=He,a=-n-t/2,l=t+2*n;e.attr("x",a).attr("y",a).attr("rx",4).attr("ry",4).attr("width",l).attr("height",l)})(t.append("rect")),t.append("path").attr("d",((e,t)=>{const n=-t/2,a=-e/2,l=e/2,o=t/2;return`M${o},${l}H${l}V${o}H${a}V${l}H${n}V${a}H${a}V${n}H${l}V${a}H${o}V${l}Z`})(2,He.side)),t},Tt=e=>{const t=Pt(e);return t.on("click",oe),t},jt=e=>{const t=e.append("g");return t.append("rect").attr("x",-We/2).attr("y",-Ye/2).attr("width",We).attr("height",Ye).attr("rx",Ue).attr("ry",Ue).attr("stroke",(e=>e.color||"grey")).attr("fill",(e=>e.color||"grey")),Ct(t.append("circle"),-4),Ct(t.append("circle"),0),Ct(t.append("circle"),4),t},Gt=e=>{var t;const n=!(null==(t=e.data()[0])?void 0:t.depth),a=e.append("g");$t(a),Et(a.append("path"));const l=a.append("g").attr("class",W.content),o=l.append("rect"),i=l.append("g").attr("class",W.text),s=i.append("rect"),r=i.append("text");Mt(r);const d=r.selectAll("tspan").data(wt).enter().append("tspan");let c;Bt(d),Je.value&&(c=Tt(l));const h=jt(l);return kt(n,o,s,h,c),((e,t)=>{if(e.select(`:scope > g.${W.content} > g.${W["expand-btn"]}`).on("click",se),Qe.value.drag||Qe.value.edit){const n=e.select(`:scope > g.${W.content} > g.${W.text}`);n.on("mousedown",ee),Qe.value.drag&&!t&&qe(n),Qe.value.edit&&n.on("click",te)}Je.value&&e.select(`:scope > g.${W.content}`).on("mouseenter",X).on("mouseleave",Q)})(a,n),a.each(((e,t)=>{e.children&&Kt(e.children,a.filter(((e,n)=>t===n)))})),l.raise(),a},Ot=e=>{var t;const n=!(null==(t=e.data()[0])?void 0:t.depth),a=lt(500,g);$t(e,a),Et(e.select(":scope > path"),a);const l=e.select(`:scope > g.${W.content}`),o=l.select(":scope > rect"),i=l.select(`g.${W.text}`),s=i.select("rect"),r=i.select("text");Mt(r,a),r.selectAll("tspan").data(wt).join(At,Vt,(e=>e.remove()));let d=l.select(`g.${W["add-btn"]}`);const c=l.select(`g.${W["expand-btn"]}`);return Je.value?d.node()||(d=Tt(l)):d.remove(),kt(n,o,s,c,d),e.each(((t,n)=>{t.children&&Kt(t.children,e.filter(((e,t)=>n===t)))})),l.raise(),e},Kt=(e=[un.data],t=he)=>{t.selectAll(`g.${bt(e[0]).join(".")}`).data(e,(e=>e.gKey)).join(Gt,Ot)};class Rt{constructor(e,t,n,a){this.w=e,this.h=t,this.y=n,this.c=a,this.cs=a.length,this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}}function Ht(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function It(e){return e.y+e.h}class Wt{constructor(e,t,n){this.lowY=e,this.index=t,this.next=n}}function Yt(e,t,n){for(;null!==n&&e>=n.lowY;)n=n.next;return new Wt(e,t,n)}function Ut(e,t,n,a){e.c[t].mod+=a,e.c[t].msel+=a,e.c[t].mser+=a,function(e,t,n,a){if(n!==t-1){const l=t-n;e.c[n+1].shift+=a/l,e.c[t].shift-=a/l,e.c[t].change-=a-a/l}}(e,t,n,a)}function Ft(e){return 0===e.cs?e.tl:e.c[0]}function Zt(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function qt(e,t,n){let a=e.c[t-1],l=a.mod,o=e.c[t],i=o.mod;for(;null!==a&&null!==o;){It(a)>n.lowY&&(n=n.next);const s=l+a.prelim+a.w-(i+o.prelim);s>0&&(i+=s,Ut(e,t,n.index,s));const r=It(a),d=It(o);r<=d&&(a=Zt(a),null!==a&&(l+=a.mod)),r>=d&&(o=Ft(o),null!==o&&(i+=o.mod))}null===a&&null!==o?function(e,t,n,a){const l=e.c[0].el;l.tl=n;const o=a-n.mod-e.c[0].msel;l.mod+=o,l.prelim-=o,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,o,i):null!==a&&null===o&&function(e,t,n,a){const l=e.c[t].er;l.tr=n;const o=a-n.mod-e.c[t].mser;l.mod+=o,l.prelim-=o,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,a,l)}function Jt(e){if(0===e.cs)return void Ht(e);Jt(e.c[0]);let t=Yt(It(e.c[0].el),0,null);for(let n=1;n<e.cs;n++){Jt(e.c[n]);const a=It(e.c[n].er);qt(e,n,t),t=Yt(a,n,t)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(e),Ht(e)}function Xt(e,t){t+=e.mod,e.x=e.prelim+t,function(e){let t=0,n=0;for(let a=0;a<e.cs;a++)t+=e.c[a].shift,n+=t+e.c[a].change,e.c[a].mod+=n}(e);for(let n=0;n<e.cs;n++)Xt(e.c[n],t)}function Qt(e){Jt(e),Xt(e,0)}class en{constructor(e,t){this.gap=e,this.bottomPadding=t}addBoundingBox(e,t){return{width:e+this.gap,height:t+this.bottomPadding}}removeBoundingBox(e,t){return{x:e+this.gap/2,y:t}}}class tn{constructor(e){this.bb=e}layout(e){const t=this.convert(e);Qt(t);const{boundingBox:n,result:a}=this.assignLayout(t,e);return{result:a,boundingBox:n}}convert(e,t=0){const{width:n,height:a}=this.bb.addBoundingBox(e.width,e.height),l=[];if(e.children&&e.children.length)for(let o=0;o<e.children.length;o++)l[o]=this.convert(e.children[o],t+a);return new Rt(n,a,t,l)}assignCoordinates(e,t){const{x:n,y:a}=this.bb.removeBoundingBox(e.x,e.y);t.x=n,t.y=a;for(let l=0;l<e.c.length;l++)this.assignCoordinates(e.c[l],t.children[l])}getSize(e,t){const{x:n,y:a,width:l,height:o}=e;if(t||(t={left:n,right:n+l,top:a,bottom:a+o}),t.left=Math.min(t.left,n),t.right=Math.max(t.right,n+l),t.top=Math.min(t.top,a),t.bottom=Math.max(t.bottom,a+o),e.children)for(const i of e.children)this.getSize(i,t);return t}assignLayout(e,t,n){const{x:a,y:l}=this.bb.removeBoundingBox(e.x,e.y);t.x=a,t.y=l;const{width:o,height:i}=t;n||(n={left:a,right:a+o,top:l,bottom:l+i}),n.left=Math.min(n.left,a),n.right=Math.max(n.right,a+o),n.top=Math.min(n.top,l),n.bottom=Math.max(n.bottom,l+i);for(let s=0;s<e.c.length;s++)this.assignLayout(e.c[s],t.children[s],n);return{result:t,boundingBox:n}}}const nn=e=>[e.width,e.height]=[e.height,e.width],an=e=>{e.parent?(e.dx=e.x-e.parent.x,e.dy=e.y-e.parent.y):(e.dx=0,e.dy=0)},ln=(e,t)=>e.id=t,on=e=>{e.parent?e.depth=e.parent.depth+1:e.depth=0},sn=e=>{e.parent&&e.parent.color&&(e.color=e.parent.color)},rn=e=>{e.depth>1&&e.parent&&(e.left=e.parent.left)},dn=(e,t,n="0")=>{var a;t.forEach((t=>{t(e,n)}));const{children:l}=e;if(l)for(let o=0;o<l.length;){const i=l[o];"del"===i.id?(l.splice(o,1),null==(a=e.rawData.children)||a.splice(o,1)):(dn(i,t,`${n}-${o}`),o+=1)}},cn=(e,t)=>{const n=new en(t,e);return new tn(n)};class hn{constructor(e,t,n,a,l=f(v)){this.colorNumber=0,this.gKey=0,this.rootWidth=0,this.diffY=0,this.colorScale=l,this.getSize=a,this.layout=cn(t,n),this.data=this.createMdataFromData(e,"0"),this.renew()}createMdataFromData(e,t,n=null){const{name:a,collapse:l,children:o}=e,{width:i,height:s}=this.getSize(a),r=n?n.depth+1:0;let d=!1,c=n?n.color:"";1===r?(d=!!e.left,c=this.colorScale(`${this.colorNumber+=1}`)):0!==r&&n&&(d=n.left);const h={id:t,name:a,rawData:e,parent:n,left:d,color:c,depth:r,x:0,y:0,dx:0,dy:0,px:0,py:0,width:i,height:s,children:[],_children:[],collapse:!!l,gKey:this.gKey+=1};return o&&(h.collapse?o.forEach(((e,n)=>{h._children.push(this.createMdataFromData(e,`${t}-${n}`,h))})):o.forEach(((e,n)=>{h.children.push(this.createMdataFromData(e,`${t}-${n}`,h))}))),h}renew(...e){dn(this.data,[nn,on,rn]),this.data=this.l(this.data);const t=[nn,this.renewXY.bind(this),an];dn(this.data,t.concat(e))}l(e){const{left:t,right:n}=(e=>{const t=Object.assign({},e),n=Object.assign({},e);if(e.collapse);else{const{children:a}=e;t.children=[],n.children=[],a.forEach((e=>{e.left?t.children.push(e):n.children.push(e),e.parent&&(e.parent=n)}))}return{left:t,right:n}})(e);return this.layout.layout(t),this.layout.layout(n),this.diffY=n.x-t.x,this.rootWidth=t.height,n.children=e.children,n}renewXY(e){[e.x,e.y]=[e.y,e.x],e.left&&(e.x=-e.x+this.rootWidth,e.y+=this.diffY)}getRootWidth(){return this.rootWidth}setBoundingBox(e,t){this.layout=cn(e,t),this.renew()}find(e){const t=e.split("-").map((e=>~~e));let n=this.data;for(let a=1;a<t.length;a++){const e=t[a],{children:l}=n;if(!(e<l.length))return null;n=l[e]}return n.id===e?n:null}rename(e,t){if(e.length>0){const n=this.find(e);if(n&&n.name!==t){n.name=t,n.rawData.name=t;const e=this.getSize(n.name);n.width=e.width,n.height=e.height,this.renew()}return n}return null}moveChild(e,t){var n,a;if(e===t)return null;const l=this.find(e),o=this.find(t),i=t.split("-").pop();if(i&&l&&o){const e=o.parent;null==(n=null==e?void 0:e.children)||n.splice(~~i,1),null==(a=null==e?void 0:e.rawData.children)||a.splice(~~i,1),o.parent=l,o.gKey=this.gKey+=1,o.depth=o.parent.depth+1,1===o.depth?o.color=this.colorScale(`${this.colorNumber+=1}`):o.left=o.parent.left,l.collapse?l._children.push(o):l.children.push(o),l.rawData.children?l.rawData.children.push(o.rawData):l.rawData.children=[o.rawData],this.renew(ln,sn)}return o}moveSibling(e,t,n=0){const a=e.split("-"),l=t.split("-");let o=a.pop(),i=l.pop();if(e===t||a.length!==l.length||!o||!i)return null;const s=this.find(e),r=this.find(t);if(r&&s&&s.parent){o=parseInt(o,10),i=parseInt(i,10),o<i&&(i-=1);const{children:e}=s.parent,{children:t}=s.parent.rawData;if(e&&t)return e.splice(o,1),e.splice(i+n,0,s),t.splice(o,1),t.splice(i+n,0,s.rawData),1===s.depth&&(s.left=r.left),this.renew(ln),s}return null}add(e,t){const n=this.find(e);if(n){if(n.collapse&&this.expand(e),n.rawData.children||(n.rawData.children=[]),"string"==typeof t){const e=t,a=this.getSize(e),l={name:e},o=n.color?n.color:this.colorScale(`${this.colorNumber+=1}`),i={id:`${n.id}-${n.children.length}`,name:e,rawData:l,parent:n,left:n.left,collapse:!1,color:o,gKey:this.gKey+=1,width:a.width,height:a.height,depth:n.depth+1,x:0,y:0,dx:0,dy:0,px:0,py:0,children:[],_children:[]};return n.children.push(i),n.rawData.children.push(l),this.renew(),i}{const e=t,a=this.createMdataFromData(e,`${n.id}-${n.children.length}`,n);return n.children.push(a),n.rawData.children.push(e),this.renew(),a}}return null}expand(e){return this.eoc(e,!1,[sn,ln])}collapse(e){return this.eoc(e,!0)}eoc(e,t,n=[]){const a=this.find(e);return a&&(a.collapse=t,a.rawData.collapse=t,[a._children,a.children]=[a.children,a._children],this.renew(...n)),a}delete(e){const t=this.find(e);if(!t||!t.parent)throw new Error(t?"暂不支持删除根节点":"未找到需要删除的节点");t.id="del",this.renew(ln)}deleteOne(e){var t;const n=this.find(e);if(n&&n.parent){const{parent:a,children:l,_children:o,collapse:i,rawData:s}=n,r=parseInt(e.split("-").pop(),10);a.children.splice(r,1,...i?o:l),null==(t=a.rawData.children)||t.splice(r,1,...s.children||[]),l.forEach((e=>{e.parent=a,1===e.depth&&(e.rawData.left=e.left)})),this.renew(ln)}}addSibling(e,t,n=!1){var a;const l=this.find(e);if(l&&l.parent){const o=parseInt(e.split("-").pop(),10),{parent:i,left:s}=l,r={name:t,left:s},d=this.getSize(t),c=n?o:o+1,h={name:t,parent:i,children:[],_children:[],color:i.color?i.color:this.colorScale(`${this.colorNumber+=1}`),collapse:!1,rawData:r,id:`${i.id}-${c}`,left:s,gKey:this.gKey+=1,depth:l.depth,width:d.width,height:d.height,x:0,y:0,dx:0,dy:0,px:0,py:0};return i.children.splice(c,0,h),null==(a=i.rawData.children)||a.splice(c,0,r),this.renew(ln),h}return null}addParent(e,t){var n;const a=this.find(e);if(a&&a.parent){const{parent:e,left:l,color:o}=a,i=this.getSize(t),s=parseInt(a.id.split("-").pop(),10),r={name:t,children:[a.rawData],left:l};null==(n=e.rawData.children)||n.splice(s,1,r);const d={rawData:r,left:l,name:t,color:o,collapse:!1,parent:e,id:a.id,depth:a.depth,width:i.width,height:i.height,gKey:this.gKey+=1,children:[a],_children:[],x:0,y:0,dx:0,dy:0,px:0,py:0};return a.parent=d,e.children.splice(s,1,d),this.renew(ln),d}return null}changeLeft(e){const t=this.find(e);return t&&(t.left=!t.left,this.renew()),t}}let un;I.on("mmdata",(e=>e?un=e:null));const pn=(e=!0)=>{e&&et.snap(un.data),Xe.emit("update:modelValue",b([un.data.rawData])),tt.value=et.hasPrev,nt.value=et.hasNext,Kt()},gn=(e,t)=>{un.rename(e,t),pn()},mn=(e,t)=>{un.moveChild(e,t),pn()},fn=(e,t,n=0)=>{un.moveSibling(e,t,n),pn()},vn=(e,t)=>{const n=un.add(e,t);return pn(),n},bn=e=>{un.delete(e),pn()},xn=e=>{un.deleteOne(e),pn()},yn=e=>{un.expand(e),pn()},wn=e=>{un.collapse(e),pn()},_n=(e,t,n=!1)=>{const a=un.addSibling(e,t,n);return pn(),a},kn=(e,t)=>{const n=un.addParent(e,t);return pn(),n},$n=e=>{un.changeLeft(e),pn()};x.init({fallbackLng:"zh",lng:"zh",resources:{zh:{translation:{contextmenu:{collapse:"折叠节点",expand:"展开节点",delete:"删除节点","delete-one":"删除单个节点",add:"新建子节点","add-parent":"新建父节点","add-sibling":"新建兄弟节点","add-sibling-before":"在此之前新建兄弟节点",cut:"剪切",copy:"拷贝",paste:"粘贴",selectall:"全选",zoomin:"放大",zoomout:"缩小",zoomfit:"缩放至合适大小"}}},en:{translation:{contextmenu:{collapse:"Collapse",expand:"Expand",delete:"delete","delete-one":"Delete a single node",add:"Add child node","add-parent":"Add parent node","add-sibling":"add sibling node","add-sibling-before":"add sibling node before",cut:"cut",copy:"copy",paste:"paste",selectall:"select all",zoomin:"zoom in",zoomout:"zoom out",zoomfit:"zoom fit"}}},ptBR:{translation:{contextmenu:{collapse:"Fechar",expand:"Abrir",delete:"Excluir","delete-one":"Excluir único nó",add:"Adicionar nó filho","add-parent":"Adicionar nó antes","add-sibling":"Adicionar nó abaixo","add-sibling-before":"Adicionar nó acima",cut:"Recortar",copy:"Copiar",paste:"Colar",selectall:"Selecionar tudo",zoomin:"Aproximar",zoomout:"Retrair",zoomfit:"Centralizar"}}}}});var Mn=y({name:"contextmenu",props:{contextText:{type:Object,default:{collapse:"Collapse this node",expand:"Expand from here",delete:"Delete Node","delete-one":"Delete a single node",add:"Add Child node","add-parent":"Add Parent node","add-sibling":"Add Sibling node","add-sibling-before":"Add Sibling node before",cut:"Cut",copy:"Copy",paste:"Paste",selectall:"Select all",zoomin:"Zoom in",zoomout:"Zoom out",zoomfit:"Zoom fit"}},position:{default:{top:0,left:0}},groups:Array},emits:["click-item"],setup(e,n){const a=t(!1),l=w(),o=t(),i=t(),s=_({top:0,left:0});I.on("showContextmenu",(async t=>{if(!o.value||!i.value)return;a.value=!!t,await k();const{offsetWidth:n,offsetHeight:l}=o.value,{offsetWidth:r,offsetHeight:d}=i.value,{top:c,left:h}=e.position;s.top=c+d>l?l-d-8:c,s.left=h+r>n?h-r:h}));const r=()=>a.value=!1;return{style:l,show:a,close:r,onClick:e=>{r(),n.emit("click-item",e)},menuEle:i,containerEle:o,pos:s,i18n:x}}});var Bn={container:"Contextmenu_container_1ay3t",menu:"Contextmenu_menu_1ay3t",disabled:"Contextmenu_disabled_1ay3t"};(Mn.__cssModules={}).$style=Bn,Mn.render=function(e,t,n,a,l,o){return $((S(),B("div",{class:e.style.container,ref:"containerEle"},[C("div",{onMousedown:t[1]||(t[1]=(...t)=>e.close&&e.close(...t))},null,32),C("div",{ref:"menuEle",id:e.style.menu,style:{top:e.pos.top+"px",left:e.pos.left+"px"}},[(S(!0),B(z,null,L(e.groups,((t,n)=>(S(),B("ul",{key:n},[(S(!0),B(z,null,L(t,(t=>(S(),B("li",{class:t.disabled?e.style.disabled:"",key:t.name,onClick:n=>e.onClick(t.name)},D(e.contextText[t.name]),11,["onClick"])))),128))])))),128))],12,["id"])],2)),[[M,e.show]])};var Cn=y({name:"Mindmap",components:{Contextmenu:Mn},emits:["update:modelValue"],props:{defaultScale:{type:Number,default:5},contextText:{type:Object},modelValue:{type:Array,required:!0},xGap:{type:Number,default:Oe},yGap:{type:Number,default:Ge},branch:{type:Number,default:Pe,validator:e=>e>=1&&e<=6},scaleExtent:{type:Object,default:Te},sharpCorner:Boolean,centerBtn:Boolean,fitBtn:Boolean,downloadBtn:Boolean,timetravel:Boolean,addNodeBtn:Boolean,edit:Boolean,drag:Boolean,keyboard:Boolean,ctm:Boolean,zoom:Boolean,locale:{type:String,default:"zh"}},setup:(e,t)=>(E((()=>x.changeLanguage(e.locale))),E((()=>I.emit("scale-extent",e.scaleExtent))),E((()=>I.emit("branch",e.branch))),E((()=>I.emit("sharp-corner",e.sharpCorner))),E((()=>I.emit("gap",{xGap:e.xGap,yGap:e.yGap}))),E((()=>I.emit("mindmap-context",t))),E((()=>Je.value=e.edit&&e.addNodeBtn)),E((()=>Qe.value.drag=e.drag)),E((()=>Qe.value.edit=e.edit)),N((()=>{if(!(U.value&&F.value&&Z.value&&q.value&&J.value))return;I.emit("selection-svg",a(U.value)),I.emit("selection-g",a(F.value)),I.emit("selection-asstSvg",a(Z.value)),I.emit("selection-foreign",a(q.value)),I.emit("mmdata",new hn(h.cloneDeep(e.modelValue[0]),Oe,Ge,rt)),Ve.value=!1,pn();const{svg:t,foreign:n}=K;null==n||n.raise(),J.value&&(Re.observe(J.value),J.value.addEventListener("blur",ne),J.value.addEventListener("mousedown",(e=>e.stopPropagation()))),ht(),null==t||t.on("mousedown",(()=>{const e=document.getElementsByClassName(W.selected)[0];null==e||e.classList.remove(W.selected)})),re(e.zoom),de(e.ctm)})),A((()=>[e.branch,Je.value,e.sharpCorner]),(()=>{Kt(),Ve.value=!1})),A((()=>[e.xGap,e.yGap]),(e=>{un.setBoundingBox(e[0],e[1]),Kt()})),A((()=>[e.drag,e.edit]),(e=>{(e=>{const{g:t}=K;if(!t)return;const n=t.selectAll(`g.${W.text}`);e?n.on("mousedown",ee):n.on("mousedown",null)})(e[0]||e[1]),(e=>{const{g:t}=K;if(!t)return;const n=t.selectAll(`g.node:not(.${W.root}) > g > g.${W.text}`);e?qe(n):n.on(".drag",null)})(e[0]),(e=>{const{g:t}=K;if(!J.value||!t)return;const n=t.selectAll(`g.${W.text}`);e?n.on("click",te):n.on("click",null)})(e[1])})),A((()=>e.zoom),(e=>re(e))),A((()=>e.ctm),(e=>de(e))),{wrapperEle:Y,svgEle:U,gEle:F,style:W,asstSvgEle:Z,foreignEle:q,foreignDivEle:J,centerView:ct,fitView:ht,download:gt,menu:Le,contextmenuPos:me,onClickMenu:le,next:mt,prev:ft,hasPrev:tt,hasNext:nt})});const zn={ref:"gEle"},Ln={ref:"foreignEle",style:{display:"none"}},Sn={ref:"foreignDivEle",contenteditable:""};Cn.render=function(e,t,n,a,l,o){const i=V("contextmenu");return S(),B("div",{class:e.style.container},[C("div",{id:e.style["svg-wrapper"],ref:"wrapperEle"},[(S(),B("svg",{class:e.style.svg,ref:"svgEle"},[C("g",zn,[(S(),B("foreignObject",Ln,[C("div",Sn,null,512)],512))],512)],2))],8,["id"]),(S(),B("svg",{ref:"asstSvgEle",class:e.style["asst-svg"]},null,2)),C("div",{class:[e.style["button-list"],e.style["right-bottom"]]},[e.centerBtn?(S(),B("button",{key:0,onClick:t[1]||(t[1]=t=>e.centerView())},[C("i",{class:e.style.gps},null,2)])):P("",!0),e.fitBtn?(S(),B("button",{key:1,onClick:t[2]||(t[2]=t=>e.fitView())},[C("i",{class:e.style.fit},null,2)])):P("",!0),e.downloadBtn?(S(),B("button",{key:2,onClick:t[3]||(t[3]=t=>e.download())},[C("i",{class:e.style.download},null,2)])):P("",!0)],2),e.timetravel?(S(),B("div",{key:0,class:[e.style["button-list"],e.style["right-top"]]},[C("button",{onClick:t[4]||(t[4]=(...t)=>e.prev&&e.prev(...t)),class:{[e.style.disabled]:!e.hasPrev}},[C("i",{class:e.style.prev},null,2)],2),C("button",{onClick:t[5]||(t[5]=(...t)=>e.next&&e.next(...t)),class:{[e.style.disabled]:!e.hasNext}},[C("i",{class:e.style.next},null,2)],2)],2)):P("",!0),e.ctm?(S(),B(i,{key:1,position:e.contextmenuPos,groups:e.menu,onClickItem:e.onClickMenu,contextText:e.contextText},null,8,["position","groups","onClickItem","contextText"])):P("",!0)],2)};var Dn=y({name:"App",components:{Mindmap:Cn},setup(){const e=_({"center-btn":{value:!0},"fit-btn":{value:!0},timetravel:{value:!0},"download-btn":{value:!0},"add-node-btn":{value:!0},keyboard:{value:!1,disabled:!0},zoom:{value:!0},drag:{value:!0},edit:{value:!0},contextmenu:{value:!0},"sharp-corner":{value:!1},vertical:{value:!1,disabled:!0}}),n=_({branch:{value:4,min:1,max:6},"x-gap":{value:84,min:0,max:100},"y-gap":{value:18,min:0,max:100}});return{data:t(R),contextText:t(H),checkboxList:e,rangeList:n,onChange:()=>console.log("update:model-value"),locale:t("en")}}});const En={class:"container"},Nn=C("div",{class:"left-top"},[C("a",{href:"https://github.com/hellowuxin/vue3-mindmap",target:"_blank"},"GitHub")],-1),An=C("div",{class:"right-top"},[C("span",null,"Props")],-1),Vn={class:"right-bottom"},Pn=C("label",{for:"language-select"},"Language",-1),Tn=C("option",{value:"zh"},"简体中文",-1),jn=C("option",{value:"en"},"English",-1),Gn=C("option",{value:"ptBR"},"Brazilian Portuguese",-1);Dn.render=function(e,t,n,a,l,o){const i=V("mindmap");return S(),B("div",En,[Nn,An,C(i,{class:"left-bottom",modelValue:e.data,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.data=t),e.onChange],branch:e.rangeList.branch.value,"x-gap":e.rangeList["x-gap"].value,"y-gap":e.rangeList["y-gap"].value,zoom:e.checkboxList.zoom.value,"fit-btn":e.checkboxList["fit-btn"].value,"center-btn":e.checkboxList["center-btn"].value,"download-btn":e.checkboxList["download-btn"].value,drag:e.checkboxList.drag.value,edit:e.checkboxList.edit.value,"add-node-btn":e.checkboxList["add-node-btn"].value,"sharp-corner":e.checkboxList["sharp-corner"].value,ctm:e.checkboxList.contextmenu.value,timetravel:e.checkboxList.timetravel.value,locale:e.locale,contextText:e.contextText},null,8,["modelValue","branch","x-gap","y-gap","zoom","fit-btn","center-btn","download-btn","drag","edit","add-node-btn","sharp-corner","ctm","timetravel","onUpdate:modelValue","locale","contextText"]),C("div",Vn,[C("div",null,[Pn,$(C("select",{id:"language-select","onUpdate:modelValue":t[2]||(t[2]=t=>e.locale=t)},[Tn,jn,Gn],512),[[T,e.locale]])]),(S(!0),B(z,null,L(e.checkboxList,((e,t)=>(S(),B("div",{key:t},[$(C("input",{type:"checkbox",name:t.toString(),"onUpdate:modelValue":t=>e.value=t,disabled:e.disabled},null,8,["name","onUpdate:modelValue","disabled"]),[[j,e.value]]),C("label",{for:t.toString()},D(t),9,["for"])])))),128)),(S(!0),B(z,null,L(e.rangeList,((e,t)=>(S(),B("div",{key:t},[$(C("input",{type:"range",name:t,"onUpdate:modelValue":t=>e.value=t,min:e.min,max:e.max},null,8,["name","onUpdate:modelValue","min","max"]),[[G,e.value,void 0,{number:!0}]]),C("label",{for:t},D(t)+"（"+D(e.value)+"）",9,["for"])])))),128))])])},O(Dn).mount("#app");
